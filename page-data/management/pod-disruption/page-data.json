{"componentChunkName":"component---src-pages-management-pod-disruption-md","path":"/management/pod-disruption/","result":{"pageContext":{"frontmatter":{"title":"Pod Disruption Budgets","excerpt":"Pod Disruption.","categories":"management","slug":"pod-disruption","toc":true},"relativePagePath":"/management/pod-disruption.md","titleType":"page","MdxNode":{"id":"f70455bd-1536-5438-a333-b82c2c57a3a6","children":[],"parent":"e3a8e1ac-abf4-5e4f-9626-6b9f690d76b0","internal":{"content":"---\ntitle: \"Pod Disruption Budgets\"\nexcerpt: \"Pod Disruption.\"\ncategories: management\nslug: pod-disruption\ntoc: true\n---\n<!--                                                                    -->\n<!-- (C) Copyright Merative US L.P. and others 2018, 2023                -->\n<!--                                                                    -->\n<!-- SPDX-License-Identifier: Apache-2.0                                -->\n<!--                                                                    -->\n\n\nThe Pod Disruption Budget (pdb) limits the number of pods that are down simultaneously from voluntary disruptions.  Refer to these links for information on disruptions and Pod Disruption Budgets.\n - [Disruptions](https://kubernetes.io/docs/concepts/workloads/pods/disruptions/)\n - [Pod Disruption Budgets](https://kubernetes.io/docs/tasks/run-application/configure-pdb/)\n - [OpenShift documentation](https://docs.openshift.com/container-platform/4.9/nodes/pods/nodes-pods-configuring.html#nodes-pods-configuring-pod-distruption-about_nodes-pods-configuring)\n\nA pdb is not required but may be desired if you are running 2 or more replicas of ACD and want to ensure a minimal availability when cluster maintenance (such as node replacement) is done. Be aware that if you have a minimum availability of 1 in a pod disruption budget and a deployment has a replica count of 1, the pod will never be moved by the scheduler and will cause voluntary maintenance such as replacing nodes to hang.    \n\nTo use a pdb with ACD, create a Pod Disruption Budget object for each ACD deployment. The examples below can be used to do this.\n### Pod Disruption Budget Setup\nDownload the following example yaml and save it as acd-pdb.yaml locally.  Edit the spec as desired.  \n```yaml acd-pdb.yaml\nkind: List\napiVersion: v1\nitems:\n- apiVersion: policy/v1\n  kind: PodDisruptionBudget\n  metadata:\n    name: merative-acd-acd-pdb\n  spec:\n    minAvailable: 1\n    selector:\n      matchLabels:\n        app.kubernetes.io/name: merative-acd-acd\n- apiVersion: policy/v1\n  kind: PodDisruptionBudget\n  metadata:\n    name: merative-acd-aci-pdb\n  spec:\n    minAvailable: 1\n    selector:\n      matchLabels:\n        app.kubernetes.io/name: merative-acd-aci\n- apiVersion: policy/v1\n  kind: PodDisruptionBudget\n  metadata:\n    name: merative-acd-av-pdb\n  spec:\n    minAvailable: 1\n    selector:\n      matchLabels:\n        app.kubernetes.io/name: merative-acd-av\n- apiVersion: policy/v1\n  kind: PodDisruptionBudget\n  metadata:\n    name: merative-acd-cd-pdb\n  spec:\n    minAvailable: 1\n    selector:\n      matchLabels:\n        app.kubernetes.io/name: merative-acd-cd\n- apiVersion: policy/v1\n  kind: PodDisruptionBudget\n  metadata:\n    name: merative-acd-cds-pdb\n  spec:\n    minAvailable: 1\n    selector:\n      matchLabels:\n        app.kubernetes.io/name: merative-acd-cds\n- apiVersion: policy/v1\n  kind: PodDisruptionBudget\n  metadata:\n    name: merative-acd-cv-pdb\n  spec:\n    minAvailable: 1\n    selector:\n      matchLabels:\n        app.kubernetes.io/name: merative-acd-cv\n- apiVersion: policy/v1\n  kind: PodDisruptionBudget\n  metadata:\n    name: merative-acd-hyp-pdb\n  spec:\n    minAvailable: 1\n    selector:\n      matchLabels:\n        app.kubernetes.io/name: merative-acd-hyp\n- apiVersion: policy/v1\n  kind: PodDisruptionBudget\n  metadata:\n    name: merative-acd-mod-pdb\n  spec:\n    minAvailable: 1\n    selector:\n      matchLabels:\n        app.kubernetes.io/name: merative-acd-mod\n- apiVersion: policy/v1\n  kind: PodDisruptionBudget\n  metadata:\n    name: merative-acd-neg-pdb\n  spec:\n    minAvailable: 1\n    selector:\n      matchLabels:\n        app.kubernetes.io/name: merative-acd-neg\n- apiVersion: policy/v1\n  kind: PodDisruptionBudget\n  metadata:\n    name: merative-acd-ont-pdb\n  spec:\n    minAvailable: 1\n    selector:\n      matchLabels:\n        app.kubernetes.io/name: merative-acd-ont\n- apiVersion: policy/v1\n  kind: PodDisruptionBudget\n  metadata:\n    name: merative-acd-spl-pdb\n  spec:\n    minAvailable: 1\n    selector:\n      matchLabels:\n        app.kubernetes.io/name: merative-acd-spl\n```\n\nCreate the Pod Disruption Budgets.\n\n```\noc project <acd_namespace>\noc create -f acd-pdb.yaml\n```\n\n\nCheck the status of the Pod Disruption Budgets.\n\n```\noc get pdb\n```\n\nGet details of the Pod Disruption Budgets.\n\n```\noc describe pdb\n```\n\nYou can patch the Pod Disruption Budgets and change the spec using the file with an override such as this:\n\n```\noc patch -f acd-pdb.yaml -p '{\"spec\":{\"minAvailable\":0}}'\n```\n\nIf you no long want the Pod Disruption Budgets you can remove them using:\n\n```\noc delete pdb -f acd-pdb.yaml\n```\n","type":"Mdx","contentDigest":"47bce4d8c55e2ef35852ed6786900ffb","owner":"gatsby-plugin-mdx","counter":235},"frontmatter":{"title":"Pod Disruption Budgets","excerpt":"Pod Disruption.","categories":"management","slug":"pod-disruption","toc":true},"excerpt":"Pod Disruption.","exports":{},"rawBody":"---\ntitle: \"Pod Disruption Budgets\"\nexcerpt: \"Pod Disruption.\"\ncategories: management\nslug: pod-disruption\ntoc: true\n---\n<!--                                                                    -->\n<!-- (C) Copyright Merative US L.P. and others 2018, 2023                -->\n<!--                                                                    -->\n<!-- SPDX-License-Identifier: Apache-2.0                                -->\n<!--                                                                    -->\n\n\nThe Pod Disruption Budget (pdb) limits the number of pods that are down simultaneously from voluntary disruptions.  Refer to these links for information on disruptions and Pod Disruption Budgets.\n - [Disruptions](https://kubernetes.io/docs/concepts/workloads/pods/disruptions/)\n - [Pod Disruption Budgets](https://kubernetes.io/docs/tasks/run-application/configure-pdb/)\n - [OpenShift documentation](https://docs.openshift.com/container-platform/4.9/nodes/pods/nodes-pods-configuring.html#nodes-pods-configuring-pod-distruption-about_nodes-pods-configuring)\n\nA pdb is not required but may be desired if you are running 2 or more replicas of ACD and want to ensure a minimal availability when cluster maintenance (such as node replacement) is done. Be aware that if you have a minimum availability of 1 in a pod disruption budget and a deployment has a replica count of 1, the pod will never be moved by the scheduler and will cause voluntary maintenance such as replacing nodes to hang.    \n\nTo use a pdb with ACD, create a Pod Disruption Budget object for each ACD deployment. The examples below can be used to do this.\n### Pod Disruption Budget Setup\nDownload the following example yaml and save it as acd-pdb.yaml locally.  Edit the spec as desired.  \n```yaml acd-pdb.yaml\nkind: List\napiVersion: v1\nitems:\n- apiVersion: policy/v1\n  kind: PodDisruptionBudget\n  metadata:\n    name: merative-acd-acd-pdb\n  spec:\n    minAvailable: 1\n    selector:\n      matchLabels:\n        app.kubernetes.io/name: merative-acd-acd\n- apiVersion: policy/v1\n  kind: PodDisruptionBudget\n  metadata:\n    name: merative-acd-aci-pdb\n  spec:\n    minAvailable: 1\n    selector:\n      matchLabels:\n        app.kubernetes.io/name: merative-acd-aci\n- apiVersion: policy/v1\n  kind: PodDisruptionBudget\n  metadata:\n    name: merative-acd-av-pdb\n  spec:\n    minAvailable: 1\n    selector:\n      matchLabels:\n        app.kubernetes.io/name: merative-acd-av\n- apiVersion: policy/v1\n  kind: PodDisruptionBudget\n  metadata:\n    name: merative-acd-cd-pdb\n  spec:\n    minAvailable: 1\n    selector:\n      matchLabels:\n        app.kubernetes.io/name: merative-acd-cd\n- apiVersion: policy/v1\n  kind: PodDisruptionBudget\n  metadata:\n    name: merative-acd-cds-pdb\n  spec:\n    minAvailable: 1\n    selector:\n      matchLabels:\n        app.kubernetes.io/name: merative-acd-cds\n- apiVersion: policy/v1\n  kind: PodDisruptionBudget\n  metadata:\n    name: merative-acd-cv-pdb\n  spec:\n    minAvailable: 1\n    selector:\n      matchLabels:\n        app.kubernetes.io/name: merative-acd-cv\n- apiVersion: policy/v1\n  kind: PodDisruptionBudget\n  metadata:\n    name: merative-acd-hyp-pdb\n  spec:\n    minAvailable: 1\n    selector:\n      matchLabels:\n        app.kubernetes.io/name: merative-acd-hyp\n- apiVersion: policy/v1\n  kind: PodDisruptionBudget\n  metadata:\n    name: merative-acd-mod-pdb\n  spec:\n    minAvailable: 1\n    selector:\n      matchLabels:\n        app.kubernetes.io/name: merative-acd-mod\n- apiVersion: policy/v1\n  kind: PodDisruptionBudget\n  metadata:\n    name: merative-acd-neg-pdb\n  spec:\n    minAvailable: 1\n    selector:\n      matchLabels:\n        app.kubernetes.io/name: merative-acd-neg\n- apiVersion: policy/v1\n  kind: PodDisruptionBudget\n  metadata:\n    name: merative-acd-ont-pdb\n  spec:\n    minAvailable: 1\n    selector:\n      matchLabels:\n        app.kubernetes.io/name: merative-acd-ont\n- apiVersion: policy/v1\n  kind: PodDisruptionBudget\n  metadata:\n    name: merative-acd-spl-pdb\n  spec:\n    minAvailable: 1\n    selector:\n      matchLabels:\n        app.kubernetes.io/name: merative-acd-spl\n```\n\nCreate the Pod Disruption Budgets.\n\n```\noc project <acd_namespace>\noc create -f acd-pdb.yaml\n```\n\n\nCheck the status of the Pod Disruption Budgets.\n\n```\noc get pdb\n```\n\nGet details of the Pod Disruption Budgets.\n\n```\noc describe pdb\n```\n\nYou can patch the Pod Disruption Budgets and change the spec using the file with an override such as this:\n\n```\noc patch -f acd-pdb.yaml -p '{\"spec\":{\"minAvailable\":0}}'\n```\n\nIf you no long want the Pod Disruption Budgets you can remove them using:\n\n```\noc delete pdb -f acd-pdb.yaml\n```\n","fileAbsolutePath":"/home/runner/work/acd-containers/acd-containers/src/pages/management/pod-disruption.md"}}},"staticQueryHashes":["1364590287","137577622","2102389209","2456312558","2610115429","2746626797","3037994772","768070550"]}